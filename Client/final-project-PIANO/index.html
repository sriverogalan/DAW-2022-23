<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PIANO</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Dancing+Script&display=swap"
      rel="stylesheet"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Oswald:wght@300&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="css/styles.css" />
  </head>

  <body class="bg">
    <div class="div-title">
      <h1>Score Finder</h1>
    </div>
    <div class="piano">
      <div class="btn-white" id="do"></div>
      <div class="btn-white" id="re">
        <div class="btn-black" id="do-sust"></div>
      </div>
      <div class="btn-white" id="mi">
        <div class="btn-black" id="re-sust"></div>
      </div>
      <div class="btn-white" id="fa"></div>
      <div class="btn-white" id="sol">
        <div class="btn-black" id="fa-sust"></div>
      </div>
      <div class="btn-white" id="la">
        <div class="btn-black" id="sol-sust"></div>
      </div>
      <div class="btn-white" id="si">
        <div class="btn-black" id="la-sust"></div>
      </div>
      <div class="btn-white" id="do7"></div>
    </div>

    <div class="piano-dev">
      <div class="search-song">
        <h2>CERCANT...</h2>
        <p id="cerca"></p>
        <button class="btn-red" onclick="borrarCerca()">Esborrar</button>
      </div>
      <div class="results">
        <h2>RESULTATS:</h2>
        <div>
          <div>
            <h3>La Balanguera</h3>
            <p>Lletra</p>
          </div>
          <button class="btn-red" id="balanguera">
            Reproduir <br />
            canço
          </button>
        </div>
        <div>
          <div>
            <h3>Happy Birthday</h3>
            <p>Lletra</p>
          </div>
          <button class="btn-red" id="happybirthday">
            Reproduir <br />
            canço
          </button>
        </div>
      </div>
    </div>
  </body>
  <script>
    let notes = [
      "do",
      "re",
      "mi",
      "fa",
      "sol",
      "la",
      "si",
      "do-sust",
      "re-sust",
      "fa-sust",
      "sol-sust",
      "la-sust",
      "do7",
    ];

    const partitures = {
      balanguera: ["do", "re", "mi", "fa", "fa", "sol", "la-sust", "la-sust"],
      happybirthday: [
        "do",
        "do",
        "re",
        "do",
        "fa",
        "mi",
        "do",
        "do",
        "re",
        "do",
        "sol",
        "fa",
      ],
    };

    let cerca = [];

    function Nota(nom) {
      this.nom = nom;
      this.src = `audio/${nom}.mp3`;
    }

    function sonarTecla(nota) {
      let n = new Nota(nota);
      let audio = new Audio(n.src);
      audio.play();
    }

    function borrarCerca() { 
        cerca = [];
        document.getElementById("cerca").innerHTML = "";
    }

    function assignarTeclesPiano() {
      for (let i = 0; i < notes.length; i++) {
        let nota = notes[i];
        let tecla = document
          .querySelector("#" + notes[i])
          .addEventListener("click", () => {
            sonarTecla(nota);
            cerca.push(nota);
            document.querySelector("#cerca").innerHTML = cerca;
          });
      }
    } 

    assignarTeclesPiano();

    function sonarPartitura(partitura) {
      let partituraSeleccionada = partitures[partitura];
      let i = 0;
      let interval;
      let interval2 = clearInterval(interval);
      interval = setInterval(() => {
        sonarTecla(partituraSeleccionada[i]);
        i++;
        if (i >= partituraSeleccionada.length) {
          clearInterval(interval);
        }
      }, 700);
    }

    function cercadorPartitures() {
        
    }

    /* sonar tecla partitures*/

    document
      .querySelector("#balanguera")
      .addEventListener("click", () => sonarPartitura("balanguera"));
    document
      .querySelector("#happybirthday")
      .addEventListener("click", () => sonarPartitura("happybirthday"));
  </script>
</html>
